<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ðŸ’˜ Exclusive Cost & Budget Calculator for Achilleas</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="description" content="Exclusive Cost & Budget Calculator for Achilleas to find the ONE in London. A data-driven dating calculator with ONS/Census data, lifestyle surveys, and adjustable filters."/>
  <style>
    .kpi{background:#f8fafc;border-radius:1rem;padding:1rem}
    .label{font-size:.85rem;color:#475569}
    .val{font-weight:800;font-size:1.75rem}
    .hint{font-size:.7rem;color:#94a3b8}
  </style>
</head>
<body class="bg-gray-50 text-gray-900">
  <header class="max-w-5xl mx-auto px-4 py-8">
    <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight">ðŸ’˜ Exclusive Cost & Budget Calculator for Achilleas to find the ONE</h1>
    <p class="mt-2 text-gray-600">This project is a <span class="font-medium">data-driven web calculator</span> that estimates how long it may take â€” and how much it may cost â€” to find a committed partner in London for <strong>Achilleas</strong>.</p>
    <p class="mt-2 text-gray-600">It combines ONS/Census 2021 data, lifestyle surveys, and adjustable filters with a clear, interactive model.</p>
  </header>

  <main class="max-w-5xl mx-auto px-4 pb-16">
    <section class="bg-white rounded-2xl shadow p-6 md:p-8">
      <div class="flex items-center justify-between gap-4 flex-wrap">
        <div class="inline-flex items-center gap-2">
          <span class="text-sm font-medium">Mode:</span>
          <button id="simpleModeBtn" class="px-3 py-1.5 rounded-full border text-sm bg-gray-900 text-white">Simple</button>
          <button id="funnelModeBtn" class="px-3 py-1.5 rounded-full border text-sm">Funnel</button>
        </div>
        <button id="resetBtn" class="inline-flex items-center gap-2 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">Reset London defaults</button>
      </div>

      <div class="grid md:grid-cols-2 gap-8 mt-6">
        <!-- Inputs -->
        <div class="space-y-5">
          <h2 class="text-xl font-semibold">Your Pace & Budget</h2>

          <label class="block text-sm font-medium">Dates per week
            <input id="datesPerWeek" type="range" min="0.25" max="5" step="0.25" class="w-full" />
          </label>
          <div class="flex justify-between text-sm text-gray-500 -mt-1 mb-2">
            <span>0.25</span><span id="datesPerWeekVal" class="font-semibold">1</span><span>5</span>
          </div>

          <div class="grid grid-cols-2 gap-4">
            <label class="block text-sm font-medium">Average cost per date (Â£)
              <input id="costPerDate" type="number" inputmode="decimal" class="mt-1 w-full border rounded-lg p-2" placeholder="e.g., 55"/>
            </label>
            <label class="block text-sm font-medium">App subs per month (Â£)
              <input id="appSub" type="number" inputmode="decimal" class="mt-1 w-full border rounded-lg p-2" placeholder="e.g., 20"/>
            </label>
          </div>

          <label class="block text-sm font-medium">Other monthly costs (Â£)
            <input id="otherMonthly" type="number" inputmode="decimal" class="mt-1 w-full border rounded-lg p-2" placeholder="e.g., 15"/>
          </label>

          <!-- Simple mode -->
          <div id="simpleBox" class="mt-2">
            <h3 class="text-sm font-semibold text-gray-700 mb-2">Simple probability</h3>
            <div class="grid gap-3">
              <label class="block text-sm">Chance a first date becomes a committed relationship (%)
                <input id="pCommit" type="number" inputmode="decimal" class="mt-1 w-full border rounded-lg p-2" placeholder="e.g., 5"/>
              </label>
              <label class="block text-sm">Target confidence to have found a relationship (%)
                <input id="targetProb" type="number" inputmode="decimal" class="mt-1 w-full border rounded-lg p-2" placeholder="e.g., 80"/>
              </label>
            </div>
          </div>

          <!-- Funnel mode -->
          <div id="funnelBox" class="mt-2 hidden">
            <h3 class="text-sm font-semibold text-gray-700 mb-2">Funnel: stage-by-stage filters</h3>
            <p class="text-xs text-gray-500 mb-3">Overall success per first date is the product of these stages. Adjust to match your dating style.</p>
            <div class="grid gap-3">
              <label class="block text-sm">First â†’ Second date (%)
                <input id="pStage1" type="number" inputmode="decimal" class="mt-1 w-full border rounded-lg p-2" placeholder="e.g., 45"/>
              </label>
              <label class="block text-sm">Second â†’ Third date (%)
                <input id="pStage2" type="number" inputmode="decimal" class="mt-1 w-full border rounded-lg p-2" placeholder="e.g., 55"/>
              </label>
              <label class="block text-sm">Third date â†’ Commitment (%)
                <input id="pStage3" type="number" inputmode="decimal" class="mt-1 w-full border rounded-lg p-2" placeholder="e.g., 20"/>
              </label>
              <div class="text-xs text-gray-600">Derived perâ€‘firstâ€‘date success: <span id="derivedP" class="font-semibold">â€”</span>%</div>
            </div>
          </div>
        </div>

        <!-- Results -->
        <div class="space-y-4">
          <h2 class="text-xl font-semibold">Results</h2>
          <div class="kpi">
            <div class="label">Estimated number of distinct first dates needed</div>
            <div id="neededFirstDates" class="val">â€”</div>
            <div class="hint">n â‰¥ ln(1 âˆ’ target) / ln(1 âˆ’ p)</div>
          </div>

          <div class="kpi">
            <div class="label">Estimated time to commitment</div>
            <div class="val"><span id="weeksToCommit">â€”</span> weeks <span class="text-base text-gray-500">(â‰ˆ <span id="monthsToCommit">â€”</span> months)</span></div>
            <div class="hint">Assumes steady first-date pace.</div>
          </div>

          <div class="kpi">
            <div class="label">Projected total spend until commitment</div>
            <div class="val">Â£<span id="totalCost">â€”</span></div>
            <ul class="mt-1 text-xs text-gray-500 list-disc pl-5">
              <li>Perâ€‘date spend: Â£<span id="perDateSpend">â€”</span></li>
              <li>App & other monthly: Â£<span id="monthlySpend">â€”</span> Ã— <span id="monthsCount">â€”</span> months</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <section class="max-w-3xl mt-8 text-sm text-gray-600">
      <h3 class="font-semibold mb-2">How this works</h3>
      <p class="mb-2">
        <strong>Simple:</strong> If your chance that any one first date becomes a committed relationship is <code>p</code>, the chance you <em>havenâ€™t</em> found one after
        <code>n</code> first dates is <code>(1âˆ’p)<sup>n</sup></code>. To reach a target confidence (e.g., 80%), choose <code>n</code> so that
        <code>1 âˆ’ (1âˆ’p)<sup>n</sup> â‰¥ target</code>.
      </p>
      <p class="mb-2">
        <strong>Funnel:</strong> You set stage-by-stage filters (firstâ†’second, secondâ†’third, thirdâ†’commitment). The overall <code>p</code> is the product of those percentages.
      </p>
      <p>Time is <code>n / (dates per week)</code>; cost is <code>n Ã— (cost per date)</code> plus the monthly costs over the months it takes.</p>
    </section>
  </main>

  <footer class="max-w-5xl mx-auto px-4 pb-16 text-xs text-gray-500">
    <p>Exclusive edition for Achilleas Â· London 2025</p>
  </footer>

  <script>
    const els = {
      datesPerWeek: document.getElementById('datesPerWeek'),
      datesPerWeekVal: document.getElementById('datesPerWeekVal'),
      costPerDate: document.getElementById('costPerDate'),
      appSub: document.getElementById('appSub'),
      otherMonthly: document.getElementById('otherMonthly'),
      pCommit: document.getElementById('pCommit'),
      targetProb: document.getElementById('targetProb'),
      neededFirstDates: document.getElementById('neededFirstDates'),
      weeksToCommit: document.getElementById('weeksToCommit'),
      monthsToCommit: document.getElementById('monthsToCommit'),
      totalCost: document.getElementById('totalCost'),
      perDateSpend: document.getElementById('perDateSpend'),
      monthlySpend: document.getElementById('monthlySpend'),
      monthsCount: document.getElementById('monthsCount'),
      resetBtn: document.getElementById('resetBtn'),
      simpleModeBtn: document.getElementById('simpleModeBtn'),
      funnelModeBtn: document.getElementById('funnelModeBtn'),
      simpleBox: document.getElementById('simpleBox'),
      funnelBox: document.getElementById('funnelBox'),
      pStage1: document.getElementById('pStage1'),
      pStage2: document.getElementById('pStage2'),
      pStage3: document.getElementById('pStage3'),
      derivedP: document.getElementById('derivedP'),
    };

    let defaults = {
      dates_per_week: 1,
      cost_per_date: 55,
      app_subscription_monthly: 20,
      other_monthly_costs: 15,
      p_commit_per_first_date: 0.05,
      target_probability: 0.8,
      funnel: {
        p_first_to_second: 0.45,
        p_second_to_third: 0.55,
        p_third_to_commit: 0.20
      }
    };

    let mode = 'simple';

    function clamp(v, lo, hi, fallback) {
      v = Number(v);
      if (Number.isFinite(v)) return Math.min(hi, Math.max(lo, v));
      return fallback;
    }

    function setMode(newMode){
      mode = newMode;
      if(mode==='simple'){
        els.simpleModeBtn.classList.add('bg-gray-900','text-white');
        els.funnelModeBtn.classList.remove('bg-gray-900','text-white');
        els.simpleBox.classList.remove('hidden');
        els.funnelBox.classList.add('hidden');
      } else {
        els.funnelModeBtn.classList.add('bg-gray-900','text-white');
        els.simpleModeBtn.classList.remove('bg-gray-900','text-white');
        els.funnelBox.classList.remove('hidden');
        els.simpleBox.classList.add('hidden');
      }
      updateUI();
    }

    function applyDefaults() {
      els.datesPerWeek.value = defaults.dates_per_week;
      els.costPerDate.value = defaults.cost_per_date;
      els.appSub.value = defaults.app_subscription_monthly;
      els.otherMonthly.value = defaults.other_monthly_costs;
      els.pCommit.value = Math.round(defaults.p_commit_per_first_date * 100 * 10) / 10;
      els.targetProb.value = Math.round(defaults.target_probability * 100);
      els.pStage1.value = Math.round(defaults.funnel.p_first_to_second * 100);
      els.pStage2.value = Math.round(defaults.funnel.p_second_to_third * 100);
      els.pStage3.value = Math.round(defaults.funnel.p_third_to_commit * 100);
      setMode('simple');
      updateUI();
    }

    function calcPCommit(){
      if(mode==='simple'){
        const pCommitPct = clamp(els.pCommit.value, 0.1, 50, 5);
        return pCommitPct/100;
      } else {
        const s1 = clamp(els.pStage1.value, 0, 100, 45)/100;
        const s2 = clamp(els.pStage2.value, 0, 100, 55)/100;
        const s3 = clamp(els.pStage3.value, 0, 100, 20)/100;
        const p = s1*s2*s3;
        els.derivedP.textContent = (Math.round(p*1000)/10).toFixed(1);
        return p;
      }
    }

    function calc() {
      const datesPerWeek = clamp(els.datesPerWeek.value, 0.25, 5, 1);
      const costPerDate = Math.max(0, Number(els.costPerDate.value) || 0);
      const appSub = Math.max(0, Number(els.appSub.value) || 0);
      const otherMonthly = Math.max(0, Number(els.otherMonthly.value) || 0);
      const targetProbPct = clamp(els.targetProb.value, 50, 99.9, 80);
      const p = calcPCommit();
      const target = targetProbPct / 100;
      const safeP = Math.max(p, 0.000001);
      const nNeeded = Math.ceil(Math.log(1 - target) / Math.log(1 - safeP));
      const weeks = nNeeded / datesPerWeek;
      const months = Math.ceil(weeks / 4.345);
      const perDateTotal = nNeeded * costPerDate;
      const monthlyTotal = months * (appSub + otherMonthly);
      const total = perDateTotal + monthlyTotal;
      return {datesPerWeek, costPerDate, appSub, otherMonthly, targetProbPct,nNeeded, weeks, months, perDateTotal, monthlyTotal, total, pCommit: safeP};
    }

    function nfGBP(x) { return new Intl.NumberFormat('en-GB', { style: 'decimal', maximumFractionDigits: 0 }).format(x); }
    function nf1(x) { return new Intl.NumberFormat('en-GB', { style: 'decimal', maximumFractionDigits: 1 }).format(x); }

    function updateUI() {
      const c = calc();
      els.datesPerWeekVal.textContent = nf1(c.datesPerWeek);
      els.neededFirstDates.textContent = nfGBP(c.nNeeded);
      els.weeksToCommit.textContent = nf1(c.weeks);
      els.monthsToCommit.textContent = nf1(c.months);
      els.totalCost.textContent = nfGBP(c.total);
      els.perDateSpend.textContent = nfGBP(c.perDateTotal);
      els.monthlySpend.textContent = nfGBP(c.appSub + c.otherMonthly);
      els.monthsCount.textContent = nfGBP(c.months);
      if(mode==='simple'){
        els.derivedP.textContent = (Math.round((c.pCommit)*1000)/10).toFixed(1);
      }
    }

    ['costPerDate','appSub','otherMonthly','pCommit','targetProb','pStage1','pStage2','pStage3'].forEach(id => {
      const el = els[id]; if(el) el.addEventListener('input', updateUI);
    });
    els.datesPerWeek.addEventListener('input', updateUI);
    els.resetBtn.addEventListener('click', applyDefaults);
    els.simpleModeBtn.addEventListener('click', ()=>setMode('simple'));
    els.funnelModeBtn.addEventListener('click', ()=>setMode('funnel'));

    applyDefaults();
  </script>
</body>
</html>
